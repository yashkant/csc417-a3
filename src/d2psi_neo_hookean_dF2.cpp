#include <d2psi_neo_hookean_dq2.h>

//Input:
//  F - the dense 3x3 deformation gradient
//  C,D - material parameters for the Neo-Hookean model
//Output:
//  psi - the 9x9 Hessian of the potential energy wrt to the deformation gradient

void d2psi_neo_hookean_dF2(Eigen::Matrix99d &ddw, Eigen::Ref<const Eigen::Matrix3d> F, double C, double D)
{
    double mu = C * 2;
    double lambda = D * 2;
    double F1_1, F1_2, F1_3, F2_1, F2_2, F2_3,F3_1, F3_2, F3_3;
    F1_1 = F(0,0);
    F1_2 = F(0,1);
    F1_3 = F(0,2);
    F2_1 = F(1,0);
    F2_2 = F(1,1);
    F2_3 = F(1,2);
    F3_1 = F(2,0);
    F3_2 = F(2,1);
    F3_3 = F(2,2);

    // Stable neo-hookean
   ddw(0, 0) = mu-mu/(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0)+lambda*pow(F2_2*F3_3-F2_3*F3_2,2.0)+(F1_1*F1_1)*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(0, 1) = -lambda*(F2_1*F3_3-F2_3*F3_1)*(F2_2*F3_3-F2_3*F3_2)+F1_1*F1_2*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(0, 2) = lambda*(F2_1*F3_2-F2_2*F3_1)*(F2_2*F3_3-F2_3*F3_2)+F1_1*F1_3*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(0, 3) = -lambda*(F1_2*F3_3-F1_3*F3_2)*(F2_2*F3_3-F2_3*F3_2)+F1_1*F2_1*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(0, 4) = -F3_3*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)+lambda*(F1_1*F3_3-F1_3*F3_1)*(F2_2*F3_3-F2_3*F3_2)+F1_1*F2_2*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(0, 5) = F3_2*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)-lambda*(F1_1*F3_2-F1_2*F3_1)*(F2_2*F3_3-F2_3*F3_2)+F1_1*F2_3*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(0, 6) = lambda*(F1_2*F2_3-F1_3*F2_2)*(F2_2*F3_3-F2_3*F3_2)+F1_1*F3_1*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(0, 7) = F2_3*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)-lambda*(F1_1*F2_3-F1_3*F2_1)*(F2_2*F3_3-F2_3*F3_2)+F1_1*F3_2*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(0, 8) = -F2_2*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)+lambda*(F1_1*F2_2-F1_2*F2_1)*(F2_2*F3_3-F2_3*F3_2)+F1_1*F3_3*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(1, 0) = -lambda*(F2_1*F3_3-F2_3*F3_1)*(F2_2*F3_3-F2_3*F3_2)+F1_1*F1_2*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(1, 1) = mu-mu/(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0)+lambda*pow(F2_1*F3_3-F2_3*F3_1,2.0)+(F1_2*F1_2)*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(1, 2) = -lambda*(F2_1*F3_2-F2_2*F3_1)*(F2_1*F3_3-F2_3*F3_1)+F1_2*F1_3*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(1, 3) = F3_3*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)+lambda*(F1_2*F3_3-F1_3*F3_2)*(F2_1*F3_3-F2_3*F3_1)+F1_2*F2_1*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(1, 4) = -lambda*(F1_1*F3_3-F1_3*F3_1)*(F2_1*F3_3-F2_3*F3_1)+F1_2*F2_2*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(1, 5) = -F3_1*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)+lambda*(F1_1*F3_2-F1_2*F3_1)*(F2_1*F3_3-F2_3*F3_1)+F1_2*F2_3*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(1, 6) = -F2_3*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)-lambda*(F1_2*F2_3-F1_3*F2_2)*(F2_1*F3_3-F2_3*F3_1)+F1_2*F3_1*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(1, 7) = lambda*(F1_1*F2_3-F1_3*F2_1)*(F2_1*F3_3-F2_3*F3_1)+F1_2*F3_2*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(1, 8) = F2_1*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)-lambda*(F1_1*F2_2-F1_2*F2_1)*(F2_1*F3_3-F2_3*F3_1)+F1_2*F3_3*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(2, 0) = lambda*(F2_1*F3_2-F2_2*F3_1)*(F2_2*F3_3-F2_3*F3_2)+F1_1*F1_3*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(2, 1) = -lambda*(F2_1*F3_2-F2_2*F3_1)*(F2_1*F3_3-F2_3*F3_1)+F1_2*F1_3*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(2, 2) = mu-mu/(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0)+lambda*pow(F2_1*F3_2-F2_2*F3_1,2.0)+(F1_3*F1_3)*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(2, 3) = -F3_2*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)-lambda*(F1_2*F3_3-F1_3*F3_2)*(F2_1*F3_2-F2_2*F3_1)+F1_3*F2_1*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(2, 4) = F3_1*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)+lambda*(F1_1*F3_3-F1_3*F3_1)*(F2_1*F3_2-F2_2*F3_1)+F1_3*F2_2*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(2, 5) = -lambda*(F1_1*F3_2-F1_2*F3_1)*(F2_1*F3_2-F2_2*F3_1)+F1_3*F2_3*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(2, 6) = F2_2*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)+lambda*(F1_2*F2_3-F1_3*F2_2)*(F2_1*F3_2-F2_2*F3_1)+F1_3*F3_1*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(2, 7) = -F2_1*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)-lambda*(F1_1*F2_3-F1_3*F2_1)*(F2_1*F3_2-F2_2*F3_1)+F1_3*F3_2*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(2, 8) = lambda*(F1_1*F2_2-F1_2*F2_1)*(F2_1*F3_2-F2_2*F3_1)+F1_3*F3_3*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(3, 0) = -lambda*(F1_2*F3_3-F1_3*F3_2)*(F2_2*F3_3-F2_3*F3_2)+F1_1*F2_1*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(3, 1) = F3_3*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)+lambda*(F1_2*F3_3-F1_3*F3_2)*(F2_1*F3_3-F2_3*F3_1)+F1_2*F2_1*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(3, 2) = -F3_2*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)-lambda*(F1_2*F3_3-F1_3*F3_2)*(F2_1*F3_2-F2_2*F3_1)+F1_3*F2_1*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(3, 3) = mu-mu/(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0)+lambda*pow(F1_2*F3_3-F1_3*F3_2,2.0)+(F2_1*F2_1)*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(3, 4) = -lambda*(F1_1*F3_3-F1_3*F3_1)*(F1_2*F3_3-F1_3*F3_2)+F2_1*F2_2*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(3, 5) = lambda*(F1_1*F3_2-F1_2*F3_1)*(F1_2*F3_3-F1_3*F3_2)+F2_1*F2_3*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(3, 6) = -lambda*(F1_2*F2_3-F1_3*F2_2)*(F1_2*F3_3-F1_3*F3_2)+F2_1*F3_1*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(3, 7) = -F1_3*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)+lambda*(F1_1*F2_3-F1_3*F2_1)*(F1_2*F3_3-F1_3*F3_2)+F2_1*F3_2*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(3, 8) = F1_2*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)-lambda*(F1_1*F2_2-F1_2*F2_1)*(F1_2*F3_3-F1_3*F3_2)+F2_1*F3_3*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(4, 0) = -F3_3*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)+lambda*(F1_1*F3_3-F1_3*F3_1)*(F2_2*F3_3-F2_3*F3_2)+F1_1*F2_2*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(4, 1) = -lambda*(F1_1*F3_3-F1_3*F3_1)*(F2_1*F3_3-F2_3*F3_1)+F1_2*F2_2*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(4, 2) = F3_1*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)+lambda*(F1_1*F3_3-F1_3*F3_1)*(F2_1*F3_2-F2_2*F3_1)+F1_3*F2_2*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(4, 3) = -lambda*(F1_1*F3_3-F1_3*F3_1)*(F1_2*F3_3-F1_3*F3_2)+F2_1*F2_2*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(4, 4) = mu-mu/(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0)+lambda*pow(F1_1*F3_3-F1_3*F3_1,2.0)+(F2_2*F2_2)*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(4, 5) = -lambda*(F1_1*F3_2-F1_2*F3_1)*(F1_1*F3_3-F1_3*F3_1)+F2_2*F2_3*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(4, 6) = F1_3*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)+lambda*(F1_2*F2_3-F1_3*F2_2)*(F1_1*F3_3-F1_3*F3_1)+F2_2*F3_1*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(4, 7) = -lambda*(F1_1*F2_3-F1_3*F2_1)*(F1_1*F3_3-F1_3*F3_1)+F2_2*F3_2*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(4, 8) = -F1_1*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)+lambda*(F1_1*F2_2-F1_2*F2_1)*(F1_1*F3_3-F1_3*F3_1)+F2_2*F3_3*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(5, 0) = F3_2*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)-lambda*(F1_1*F3_2-F1_2*F3_1)*(F2_2*F3_3-F2_3*F3_2)+F1_1*F2_3*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(5, 1) = -F3_1*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)+lambda*(F1_1*F3_2-F1_2*F3_1)*(F2_1*F3_3-F2_3*F3_1)+F1_2*F2_3*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(5, 2) = -lambda*(F1_1*F3_2-F1_2*F3_1)*(F2_1*F3_2-F2_2*F3_1)+F1_3*F2_3*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(5, 3) = lambda*(F1_1*F3_2-F1_2*F3_1)*(F1_2*F3_3-F1_3*F3_2)+F2_1*F2_3*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(5, 4) = -lambda*(F1_1*F3_2-F1_2*F3_1)*(F1_1*F3_3-F1_3*F3_1)+F2_2*F2_3*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(5, 5) = mu-mu/(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0)+lambda*pow(F1_1*F3_2-F1_2*F3_1,2.0)+(F2_3*F2_3)*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(5, 6) = -F1_2*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)-lambda*(F1_2*F2_3-F1_3*F2_2)*(F1_1*F3_2-F1_2*F3_1)+F2_3*F3_1*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(5, 7) = F1_1*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)+lambda*(F1_1*F2_3-F1_3*F2_1)*(F1_1*F3_2-F1_2*F3_1)+F2_3*F3_2*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(5, 8) = -lambda*(F1_1*F2_2-F1_2*F2_1)*(F1_1*F3_2-F1_2*F3_1)+F2_3*F3_3*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(6, 0) = lambda*(F1_2*F2_3-F1_3*F2_2)*(F2_2*F3_3-F2_3*F3_2)+F1_1*F3_1*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(6, 1) = -F2_3*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)-lambda*(F1_2*F2_3-F1_3*F2_2)*(F2_1*F3_3-F2_3*F3_1)+F1_2*F3_1*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(6, 2) = F2_2*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)+lambda*(F1_2*F2_3-F1_3*F2_2)*(F2_1*F3_2-F2_2*F3_1)+F1_3*F3_1*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(6, 3) = -lambda*(F1_2*F2_3-F1_3*F2_2)*(F1_2*F3_3-F1_3*F3_2)+F2_1*F3_1*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(6, 4) = F1_3*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)+lambda*(F1_2*F2_3-F1_3*F2_2)*(F1_1*F3_3-F1_3*F3_1)+F2_2*F3_1*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(6, 5) = -F1_2*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)-lambda*(F1_2*F2_3-F1_3*F2_2)*(F1_1*F3_2-F1_2*F3_1)+F2_3*F3_1*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(6, 6) = mu-mu/(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0)+lambda*pow(F1_2*F2_3-F1_3*F2_2,2.0)+(F3_1*F3_1)*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(6, 7) = -lambda*(F1_1*F2_3-F1_3*F2_1)*(F1_2*F2_3-F1_3*F2_2)+F3_1*F3_2*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(6, 8) = lambda*(F1_1*F2_2-F1_2*F2_1)*(F1_2*F2_3-F1_3*F2_2)+F3_1*F3_3*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(7, 0) = F2_3*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)-lambda*(F1_1*F2_3-F1_3*F2_1)*(F2_2*F3_3-F2_3*F3_2)+F1_1*F3_2*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(7, 1) = lambda*(F1_1*F2_3-F1_3*F2_1)*(F2_1*F3_3-F2_3*F3_1)+F1_2*F3_2*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(7, 2) = -F2_1*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)-lambda*(F1_1*F2_3-F1_3*F2_1)*(F2_1*F3_2-F2_2*F3_1)+F1_3*F3_2*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(7, 3) = -F1_3*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)+lambda*(F1_1*F2_3-F1_3*F2_1)*(F1_2*F3_3-F1_3*F3_2)+F2_1*F3_2*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(7, 4) = -lambda*(F1_1*F2_3-F1_3*F2_1)*(F1_1*F3_3-F1_3*F3_1)+F2_2*F3_2*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(7, 5) = F1_1*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)+lambda*(F1_1*F2_3-F1_3*F2_1)*(F1_1*F3_2-F1_2*F3_1)+F2_3*F3_2*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(7, 6) = -lambda*(F1_1*F2_3-F1_3*F2_1)*(F1_2*F2_3-F1_3*F2_2)+F3_1*F3_2*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(7, 7) = mu-mu/(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0)+lambda*pow(F1_1*F2_3-F1_3*F2_1,2.0)+(F3_2*F3_2)*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(7, 8) = -lambda*(F1_1*F2_2-F1_2*F2_1)*(F1_1*F2_3-F1_3*F2_1)+F3_2*F3_3*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(8, 0) = -F2_2*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)+lambda*(F1_1*F2_2-F1_2*F2_1)*(F2_2*F3_3-F2_3*F3_2)+F1_1*F3_3*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(8, 1) = F2_1*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)-lambda*(F1_1*F2_2-F1_2*F2_1)*(F2_1*F3_3-F2_3*F3_1)+F1_2*F3_3*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(8, 2) = lambda*(F1_1*F2_2-F1_2*F2_1)*(F2_1*F3_2-F2_2*F3_1)+F1_3*F3_3*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(8, 3) = F1_2*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)-lambda*(F1_1*F2_2-F1_2*F2_1)*(F1_2*F3_3-F1_3*F3_2)+F2_1*F3_3*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(8, 4) = -F1_1*lambda*((mu*(3.0/4.0))/lambda-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)+lambda*(F1_1*F2_2-F1_2*F2_1)*(F1_1*F3_3-F1_3*F3_1)+F2_2*F3_3*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(8, 5) = -lambda*(F1_1*F2_2-F1_2*F2_1)*(F1_1*F3_2-F1_2*F3_1)+F2_3*F3_3*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(8, 6) = lambda*(F1_1*F2_2-F1_2*F2_1)*(F1_2*F2_3-F1_3*F2_2)+F3_1*F3_3*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(8, 7) = -lambda*(F1_1*F2_2-F1_2*F2_1)*(F1_1*F2_3-F1_3*F2_1)+F3_2*F3_3*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;
   ddw(8, 8) = mu-mu/(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0)+lambda*pow(F1_1*F2_2-F1_2*F2_1,2.0)+(F3_3*F3_3)*mu*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*2.0;

}